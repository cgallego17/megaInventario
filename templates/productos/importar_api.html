{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}Importar Productos desde API - Mega Inventario{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card">
                <div class="card-header">
                    <h3><i class="bi bi-cloud-download"></i> Importar Productos desde API</h3>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <h5><i class="bi bi-info-circle"></i> Información sobre la importación desde API:</h5>
                        <p>Este formulario permite importar productos desde una API externa. El sistema mapeará automáticamente los campos disponibles.</p>
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <h6 class="text-danger">Campos Requeridos en la API:</h6>
                                <ul>
                                    <li><strong>codigo_barras</strong> (o: barcode, ean, upc, codigo)</li>
                                    <li><strong>nombre</strong> (o: name, producto, descripcion)</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h6 class="text-success">Campos Opcionales en la API:</h6>
                                <ul>
                                    <li><strong>codigo</strong>, <strong>marca</strong>, <strong>descripcion</strong></li>
                                    <li><strong>categoria</strong>, <strong>atributo</strong></li>
                                    <li><strong>precio</strong>, <strong>unidad_medida</strong></li>
                                </ul>
                            </div>
                        </div>
                        <div class="alert alert-warning mt-3 mb-0">
                            <strong><i class="bi bi-exclamation-triangle"></i> Nota:</strong>
                            <ul class="mb-0">
                                <li>La API debe devolver JSON con una lista de productos o un objeto con una clave que contenga la lista</li>
                                <li>El sistema detectará automáticamente los campos disponibles</li>
                                <li>Puede usar mapeo personalizado si los nombres de campos son diferentes</li>
                                <li>Los productos existentes (mismo código de barras) se actualizarán</li>
                            </ul>
                        </div>
                    </div>
                    
                    <form method="post">
                        {% csrf_token %}
                        {{ form|crispy }}
                        <div class="mt-3">
                            <button type="submit" class="btn btn-success">
                                <i class="bi bi-cloud-download"></i> Importar desde API
                            </button>
                            <a href="{% url 'productos:lista' %}" class="btn btn-secondary">
                                <i class="bi bi-x-circle"></i> Cancelar
                            </a>
                            <a href="{% url 'productos:importar' %}" class="btn btn-info">
                                <i class="bi bi-upload"></i> Importar desde Archivo
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}






